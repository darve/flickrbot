/*! daves-flickr-bot 02-01-2014 */
!function(a,b){"use strict";var c,d,e={},f={},g={},h=[],i=!1,j=!1,k="5e0c3a5a074554ab8740d758e7384a3a",l="http://api.flickr.com/services/rest/?api_key="+k,m={photos_per_page:21,query_size:300,lightbox:!0},n=function(){return n};e.init=function(a){var c,d=[];m=e.extend(m,a),g.grid=e.select(".flickr-grid"),g.masthead=e.select(".flickr-masthead"),g.lightbox=e.select("#flickr-lightbox"),g.searchbox=e.select(".flickr-search-box"),g.loadingbar=e.select(".flickr-loading-bar"),g.paging=e.select(".flickr-direction-paging"),g.status=e.select(".flickr-status"),e.addClass(g.paging.querySelector(".left"),"disabled"),e.addClass(g.status,"show"),e.listen(g.lightbox,"click",function(){g.lightbox.className=""}),e.listen(g.paging.querySelector(".left"),"click",function(a){e.prevent(a),e.page("left")}),e.listen(g.paging.querySelector(".right"),"click",function(a){e.prevent(a),e.page("right")}),length in g.searchbox&&g.searchbox.length>1&&void 0===g.searchbox.nodeType?(c=g.searchbox.length,d=g.searchbox):(c=1,d.push(g.searchbox));for(var f=0;c>f;f++)e.listen(d[f],"submit",function(a){e.prevent(a)}),e.listen(d[f].getElementsByTagName("button"),"click",function(a){e.prevent(a);var b=a.srcElement||a.target,c=b.parentNode.getElementsByTagName("input")[0].value;""!==c&&(e.search(c),b.blur(),e.hideGrid(),e.showStatus())}),e.listen(d[f].getElementsByTagName("input"),"keydown",function(a){var b=a.srcElement||a.target,c=a.which||a.keyCode;13==c&&(e.prevent(a),""!==b.value&&(e.search(b.value),b.blur(),e.hideGrid(),e.showStatus()))}),e.listen(d[f].getElementsByTagName("input"),"click",function(a){var b=a.srcElement||a.target;b.value=""});return e.hasClass(b.getElementsByTagName("html")[0],"lt-ie9")&&(b.body.style.display="none",b.body.style.display=""),e.buildGrid(),n},e.get=function(a,b){function c(){switch(d.readyState){case 1:return e.addClass(g.loadingbar,"show"),g.loadingbar.style.width="25%",void 0;case 2:return g.loadingbar.style.width="50%",void 0;case 3:return g.loadingbar.style.width="75%",void 0;case 4:g.loadingbar.style.width="100%",e.removeClass(g.loadingbar,"show"),b(d.responseText)}return 200!==d.status?(console.log("The request was made, but it was not good."),void 0):void 0}if("undefined"==typeof XDomainRequest){var d=new XMLHttpRequest;d.onreadystatechange=c,d.open("GET",a,!0),d.send("")}else{var f=new XDomainRequest;f.onload=function(){b(f.responseText)},f.open("GET",a),f.send("")}},e.buildGrid=function(){for(var a=0,c=m.photos_per_page;c>a;a++)h[a]={},h[a].image=new Image,h[a].image.className="loading",h[a].image.onload=function(){e.addClass(this,"loaded")},h[a].image.onerror=function(){e.addClass(this.parentNode,"hidden")},h[a].wrapper=b.createElement("div"),h[a].wrapper.className="item hidden",h[a].wrapper.appendChild(h[a].image),g.grid.appendChild(h[a].wrapper),m.lightbox===!0&&e.listen(h[a].image,"click",function(a){var b=a.srcElement||a.target,c=new Image;c.className="lightbox",c.src=b.getAttribute("data-lightbox"),g.lightbox.innerHTML="",g.lightbox.appendChild(c),g.lightbox.className="visible"}),a===m.photos_per_page-1&&(g.gridClear=b.createElement("div"),g.gridClear.className="clear",g.grid.appendChild(g.gridClear))},e.updateGrid=function(a,b){if("undefined"==typeof b&&(b=0),f[c].length<b+m.photos_per_page&&f[c].all===!1)e.search(c,f[c].page);else{for(var d=a.length<m.photos_per_page?a.length:m.photos_per_page,k=0;d>k;k++){var l=b+k;if("undefined"!=typeof a[l]){var n="http://farm"+a[l].farm+".staticflickr.com/"+a[l].server+"/"+a[l].id+"_"+a[l].secret+"_";h[k].image.src=n+(0===k?"q":"q")+".jpg",h[k].image.setAttribute("data-lightbox",n+"b.jpg"),h[k].image.className="loading",e.removeClass(h[k].wrapper,"hidden")}else e.addClass(h[k].wrapper,"hidden"),e.addClass(g.paging.querySelector(".right"),"disabled")}i===!1&&(i=!0),0===b&&f[c].length>=b+m.photos_per_page&&e.addClass(g.paging,"show"),j=!1}},e.search=function(a,b){var h,i="flickr.photos.search";"undefined"==typeof b?(b=1,d=1,g.paging.getElementsByTagName("span")[0].innerHTML="Page "+d,e.addClass(g.paging.querySelector(".left"),"disabled"),e.removeClass(g.paging.querySelector(".right"),"disabled"),c=a,d=b):(b++,g.paging.getElementsByTagName("span")[0].innerHTML="Page "+d),e.addClass(g.status.querySelector(".loading-animation"),"animated"),g.status.querySelector(".message").innerHTML="Loading images",e.get(l+"&method="+i+"&tags="+a+"&page="+b+"&format=json&nojsoncallback=1&per_page="+m.query_size,function(i){try{h=JSON.parse(i),0===h.photos.photo.length?(e.hideGrid(),e.showStatus(),e.removeClass(g.status.querySelector(".loading-animation"),"animated"),g.status.querySelector(".message").innerHTML="Sorry, your search returned no results."):(e.hideStatus(),1===b?f[a]=h.photos.photo:Array.prototype.push.apply(f[a],h.photos.photo),f[a].page=b,f[a].all=h.photos.photo.length<m.query_size?!0:!1,1===b?e.updateGrid(h.photos.photo):e.updateGrid(f[c],d))}catch(j){e.hideGrid(),e.showStatus(),e.removeClass(g.status.querySelector(".loading-animation"),"animated"),g.status.querySelector(".message").innerHTML="I'm terribly sorry, but an error has occurred."}return n})},e.page=function(a){if(j===!1)switch(typeof a){case"string":if("left"===a){if(d>1&&!e.hasClass(g.paging.querySelector(".left"),"disabled")){j=!0;for(var b=0,i=m.photos_per_page;i>b;b++)h[b].image.src="assets/img/trans.png";setTimeout(function(){e.updateGrid(f[c],m.photos_per_page*(d-1)),d--,g.paging.getElementsByTagName("span")[0].innerHTML="Page "+d,1===d&&e.addClass(g.paging.querySelector(".left"),"disabled")},25)}}else if("right"===a&&!e.hasClass(g.paging.querySelector(".right"),"disabled")){j=!0;for(var b=0,i=m.photos_per_page;i>b;b++)h[b].image.src="assets/img/trans.png";setTimeout(function(){e.updateGrid(f[c],m.photos_per_page*(d+1)),d++,g.paging.getElementsByTagName("span")[0].innerHTML="Page "+d,e.removeClass(g.paging.querySelector(".left"),"disabled")},25)}break;case"number":e.updateGrid(f[c],m.photos_per_page*a)}},e.showStatus=function(){g.status&&e.addClass(g.status,"show")},e.hideStatus=function(){g.status&&e.removeClass(g.status,"show")},e.hideGrid=function(){for(var a=0;a<h.length;a++)e.addClass(h[a].wrapper,"hidden");e.removeClass(g.paging,"show")},e.select=function(a){if("string"!=typeof a)return"nodeType"in a&&3===a.nodeType?a:null;if(-1!==a.indexOf("#"))return b.getElementById(a.split("#")[1]);if(-1!==a.indexOf(".")){var c=b.querySelectorAll(a);return c.length>1?c:c[0]}},e.hasClass=function(a,b){return-1===a.className.indexOf(b)?!1:!0},e.addClass=function(a,b){return-1===a.className.indexOf(b)&&(a.className+=(0===a.className.length?"":" ")+b),a},e.removeClass=function(a,b){-1!==a.className.indexOf(b)&&(-1!==a.className.indexOf(b+" ")?a.className=a.className.replace(b+" ",""):-1!==a.className.indexOf(" "+b)?a.className=a.className.replace(" "+b,""):a.className.length===b.length&&(a.className=""))},e.extend=function(a,b){for(var c in b)a[c]=a.hasOwnProperty(c)?a[c]:b[c];return a},e.prevent=function(a){a.preventDefault?a.preventDefault():a.stopPropagation?a.stopPropagation():a.returnValue=!1},e.listen=function(){return a.addEventListener?function(a,b,c){if(length in a)for(var d=0;d<a.length;d++)a[d].addEventListener(b,c,!1);else a.addEventListener(b,c,!1)}:a.attachEvent?function(a,b,c){if(length in a)for(var d=0;d<a.length;d++)a[d].attachEvent("on"+b,c);else a.attachEvent("on"+b,c)}:void 0}(),n.init=e.init,n.search=e.search,a.FlickrBot=n}(window,document);